function doPost(e) {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Sheet1");

  var data = JSON.parse(e.postData.contents);

  sheet.appendRow([
    new Date(),            // Real Date & Time
    data.batch_no || "",
    data.part_no || "",
    data.quantity || "",
    data.stage || "",
    data.status || "",
    data.operator || "",
    data.remarks || ""
  ]);

  return ContentService
    .createTextOutput(JSON.stringify({ result: "success" }))
    .setMimeType(ContentService.MimeType.JSON);
}

/* TEST FUNCTION â€“ direct URL open karne ke liye */
function doGet() {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Sheet1");
  sheet.appendRow([new Date(), "TEST", "TEST", 1, "TEST", "TEST_OK", "SYSTEM", "TEST"]);
  return ContentService.createTextOutput("OK");
}
