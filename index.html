<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Process Tracking System</title>

<style>
body {
  font-family: Arial;
  background: #f4f6f8;
  padding: 10px;
}
.tabs button {
  padding: 8px 12px;
  margin: 2px;
  border: none;
  background: #ccc;
}
.tabs button.active {
  background: #2c3e50;
  color: #fff;
}
.tab {
  display: none;
  background: #fff;
  padding: 10px;
  margin-top: 10px;
}
input, select, button {
  width: 100%;
  padding: 6px;
  margin: 4px 0;
}
table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 10px;
}
th, td {
  border: 1px solid #ccc;
  padding: 6px;
  text-align: center;
}
</style>
</head>

<body>

<h2>Production Tracking System</h2>

<div class="tabs">
  <button onclick="openTab('production')" class="active">Production</button>
  <button onclick="openTab('tempering')">Tempering</button>
  <button onclick="openTab('cleaning')">Cleaning</button>
  <button onclick="openTab('vibro')">Vibro</button>
  <button onclick="openTab('plating')">Plating</button>
  <button onclick="openTab('sorting')">Sorting</button>
  <button onclick="openTab('qa')">QA</button>
</div>

<!-- ================= PRODUCTION ================= -->
<div id="production" class="tab" style="display:block">
  <h3>Production Release</h3>

  <input id="part" placeholder="Part No">
  <input id="batch" placeholder="Batch No">
  <input id="wo" placeholder="Work Order No">
  <input id="machine" placeholder="Machine No">
  <input id="qty" type="number" placeholder="Quantity">
  <input id="plant" placeholder="Plant">
  <input id="shift" placeholder="Shift">
  <input id="grn" placeholder="GRN No">
  <input id="coil" placeholder="Coil No">

  <label>Next Process</label>
  <select id="nextProcess">
    <option>Tempering</option>
    <option>Cleaning</option>
    <option>Vibro</option>
    <option>Plating</option>
    <option>Sorting</option>
    <option>QA</option>
  </select>

  <label>Handling Type</label>
  <select id="handlingType">
    <option>Bin</option>
    <option>Bag</option>
  </select>

  <input id="handlingQty" type="number" placeholder="Qty per Bin / Bag">
  <input id="handlingCount" type="number" placeholder="No. of Bins / Bags">

  <button onclick="releaseProduction()">Release Material</button>
</div>

<!-- ================= PROCESS TABS ================= -->
<div id="tempering" class="tab">
  <h3>Tempering</h3>
  <table id="temperingTable">
    <tr><th>Batch</th><th>Part</th><th>Qty</th><th>Action</th></tr>
  </table>
</div>

<div id="cleaning" class="tab">
  <h3>Cleaning</h3>
  <table id="cleaningTable">
    <tr><th>Batch</th><th>Part</th><th>Qty</th><th>Action</th></tr>
  </table>
</div>

<div id="vibro" class="tab">
  <h3>Vibro</h3>
  <table id="vibroTable">
    <tr><th>Batch</th><th>Part</th><th>Qty</th><th>Action</th></tr>
  </table>
</div>

<div id="plating" class="tab">
  <h3>Plating</h3>
  <table id="platingTable">
    <tr><th>Batch</th><th>Part</th><th>Qty</th><th>Action</th></tr>
  </table>
</div>

<div id="sorting" class="tab">
  <h3>Sorting</h3>
  <table id="sortingTable">
    <tr><th>Batch</th><th>Part</th><th>Qty</th><th>Action</th></tr>
  </table>
</div>

<div id="qa" class="tab">
  <h3>QA</h3>
  <table id="qaTable">
    <tr><th>Batch</th><th>Part</th><th>Qty</th><th>Action</th></tr>
  </table>
</div>

<script>
const API_URL =
"https://script.google.com/macros/s/AKfycbwTWp8gsfzPW3pWUk_zY0ctvfHSmJuaFQ9jdwDCBZ0AoiBYi3GyQT4upHVop4FL4c6H/exec";

function openTab(id) {
  document.querySelectorAll('.tab').forEach(t => t.style.display="none");
  document.getElementById(id).style.display="block";
  document.querySelectorAll('.tabs button').forEach(b => b.classList.remove("active"));
  event.target.classList.add("active");
}

function releaseProduction() {
  const next = nextProcess.value;

  fetch(API_URL,{
    method:"POST",
    mode:"no-cors",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({
      current_process:"Production",
      next_process: next,
      part_no: part.value,
      batch_no: batch.value,
      work_order_no: wo.value,
      machine_no: machine.value,
      quantity: qty.value,
      plant: plant.value,
      shift: shift.value,
      grn_no: grn.value,
      coil_no: coil.value,
      handling_type: handlingType.value,
      handling_qty: handlingQty.value,
      handling_count: handlingCount.value,
      status:"OK",
      operator:"Production"
    })
  });

  addRow(next.toLowerCase()+"Table", batch.value, part.value, qty.value, next);
  alert("Released to " + next);
}

function addRow(tableId,batch,part,qty,next){
  const tr=document.createElement("tr");
  tr.innerHTML=
    `<td>${batch}</td>
     <td>${part}</td>
     <td>${qty}</td>
     <td><button onclick="processOK(this,'${next}')">OK</button></td>`;
  document.getElementById(tableId).appendChild(tr);
}

function processOK(btn,current){
  const row=btn.parentElement.parentElement;
  row.remove();
}
</script>

</body>
</html>
