<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Material Tracking System</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f6f8;
  padding: 20px;
}
h1 { margin-bottom: 20px; }
h2 { margin-top: 30px; }
table {
  width: 100%;
  border-collapse: collapse;
  background: #fff;
  margin-bottom: 20px;
}
th, td {
  border: 1px solid #ccc;
  padding: 8px;
  text-align: center;
}
th {
  background: #2c3e50;
  color: #fff;
}
button {
  padding: 6px 12px;
  cursor: pointer;
}
</style>
</head>

<body>

<h1>Material Tracking System</h1>

<!-- PRODUCTION -->
<h2>Production</h2>
<table id="production">
<tr>
  <th>Batch</th>
  <th>Part</th>
  <th>Qty</th>
  <th>Action</th>
</tr>
<tr>
  <td>B001</td>
  <td>16944495</td>
  <td>5000</td>
  <td>
    <button onclick="moveStage(this,'TEMP_OK')">Production OK</button>
  </td>
</tr>
</table>

<!-- TEMPERING -->
<h2>Tempering</h2>
<table id="tempering">
<tr>
  <th>Batch</th>
  <th>Part</th>
  <th>Qty</th>
  <th>Action</th>
</tr>
</table>

<!-- QA -->
<h2>QA</h2>
<table id="qa">
<tr>
  <th>Batch</th>
  <th>Part</th>
  <th>Qty</th>
  <th>Action</th>
</tr>
</table>

<!-- PACKING -->
<h2>Packing</h2>
<table id="packing">
<tr>
  <th>Batch</th>
  <th>Part</th>
  <th>Qty</th>
  <th>Status</th>
</tr>
</table>

<script>
/* âœ… NEW WORKING GOOGLE APPS SCRIPT URL */
const API_URL =
"https://script.google.com/macros/s/AKfycbxbuCeMG9yKM4UTEmC_OtCF4aKOJejFaaiZMkd1uwRAUw7Hn8n4SL8IJqyxlfF5LZ3U/exec";

/* SAVE DATA TO GOOGLE SHEET (CORS SAFE) */
function saveToSheet(data) {
  fetch(API_URL, {
    method: "POST",
    mode: "no-cors",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(data)
  });
}

/* MOVE MATERIAL STAGE */
function moveStage(btn, status) {
  const row = btn.parentElement.parentElement;
  const cells = row.children;

  const batch = cells[0].innerText;
  const part  = cells[1].innerText;
  const qty   = cells[2].innerText;

  // Save entry
  saveToSheet({
    batch_no: batch,
    part_no: part,
    quantity: qty,
    stage: status,
    status: status,
    operator: "Operator1",
    remarks: ""
  });

  const newRow = document.createElement("tr");
  newRow.innerHTML = `
    <td>${batch}</td>
    <td>${part}</td>
    <td>${qty}</td>
  `;

  if (status === "TEMP_OK") {
    n
